From e5cc58807c8d03554f2c3f0eee3b0b6d6f44278f Mon Sep 17 00:00:00 2001
From: HuangLiming <huangliming5@huawei.com>
Date: Sat, 22 Aug 2020 05:32:47 -0400
Subject: [PATCH] fix fbarray memseg destory error during detach without shared
 file

Signed-off-by: HuangLiming <huangliming5@huawei.com>
---
 lib/librte_eal/common/eal_common_fbarray.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/lib/librte_eal/common/eal_common_fbarray.c b/lib/librte_eal/common/eal_common_fbarray.c
index 116c695..d1aa074 100644
--- a/lib/librte_eal/common/eal_common_fbarray.c
+++ b/lib/librte_eal/common/eal_common_fbarray.c
@@ -1127,9 +1127,9 @@ rte_sec_fbarray_destroy(struct rte_fbarray *arr,
 	
 	fd = open(path, O_RDONLY);
 	if (fd < 0) {
-		RTE_LOG(ERR, EAL, "Could not open fbarray file: %s\n",
-			strerror(errno));
-		return -1;
+		RTE_LOG(WARNING, EAL, "Could not open %s: %s, and just skip it\n",
+			path, strerror(errno));
+		return 0;
 	}
 	if (flock(fd, LOCK_EX | LOCK_NB)) {
 		RTE_LOG(DEBUG, EAL, "Cannot destroy fbarray - another process is using it\n");
-- 
2.21.0

